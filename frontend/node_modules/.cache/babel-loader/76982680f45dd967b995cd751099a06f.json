{"ast":null,"code":"import _regeneratorRuntime from\"/home/thangnq/Code/netflix_mern/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/thangnq/Code/netflix_mern/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/thangnq/Code/netflix_mern/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{InfoOutlined}from\"@material-ui/icons\";import React,{useEffect,useRef,useState}from\"react\";import Category from\"../category/Category\";import{getDataAPI}from\"../../utils/fetchData\";import{useDispatch,useSelector}from\"react-redux\";import{Link,useLocation}from\"react-router-dom\";import InfoModal from\"../infomodal/InfoModal\";import\"./featured.scss\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Featured=function Featured(_ref){var type=_ref.type,listRandom=_ref.listRandom;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),bigMovie=_useState2[0],setBigMovie=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),infoModal=_useState4[0],setInfoModal=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),effectTitle=_useState6[0],setEffectTitle=_useState6[1];var _useState7=useState(\"image\"),_useState8=_slicedToArray(_useState7,2),feature=_useState8[0],setFeature=_useState8[1];var _useSelector=useSelector(function(state){return state;}),auth=_useSelector.auth,genre=_useSelector.genre;var _useState9=useState(\"/\"),_useState10=_slicedToArray(_useState9,2),pathName=_useState10[0],setPathName=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),genreChange=_useState12[0],setGenreChange=_useState12[1];var videoRef=useRef(null);var location=useLocation();var dispatch=useDispatch();useEffect(function(){var getBigMovie=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return getDataAPI(\"movie/random\".concat(type?\"?type=\"+type:\"\").concat(type&&genre?\"&genre=\"+genre:\"\"),auth.token);case 3:res=_context.sent;setBigMovie(res.data);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function getBigMovie(){return _ref2.apply(this,arguments);};}();getBigMovie();},[auth.token,type,genre]);useEffect(function(){var effectTimeout=setTimeout(function(){setEffectTitle(true);},6000);if(feature===\"image\"){var featureTimeout=setTimeout(function(){setFeature(\"video\");},3500);}if(pathName!==location.pathname||genreChange!==genre){setFeature(\"image\");setEffectTitle(false);setGenreChange(genre);setPathName(location.pathname);}return function(){clearTimeout(effectTimeout);clearTimeout(featureTimeout);};},[location.pathname,pathName,feature,dispatch,genre,genreChange]);useEffect(function(){if(feature===\"video\"){var options={rootMargin:\"0px\",threshold:[0.25,0.75]};var handlePlay=function handlePlay(entries,observer){entries.forEach(function(entry){if(videoRef.current){if(entry.isIntersecting){videoRef.current.play();}else{videoRef.current.pause();}}});};var observer=new IntersectionObserver(handlePlay,options);observer.observe(videoRef.current);}},[feature]);useEffect(function(){if(videoRef.current){if(feature===\"video\"&&infoModal){videoRef.current.pause();}else{videoRef.current.play();}}},[feature,infoModal]);return/*#__PURE__*/_jsxs(\"div\",{className:\"featured\",children:[type&&/*#__PURE__*/_jsx(Category,{type:type}),feature===\"image\"?/*#__PURE__*/_jsx(\"img\",{src:bigMovie.poster,alt:\"Movie background\",className:\"poster\"}):/*#__PURE__*/_jsx(\"video\",{ref:videoRef,className:\"video\",autoPlay:true,src:bigMovie.trailer}),/*#__PURE__*/_jsxs(\"div\",{className:\"info \".concat(effectTitle&&\"effect\"),children:[/*#__PURE__*/_jsx(\"img\",{src:bigMovie.posterTitle,alt:\"Movie name\",className:\"title\"}),/*#__PURE__*/_jsx(\"p\",{className:\"desc\",children:bigMovie.desc}),/*#__PURE__*/_jsxs(\"div\",{className:\"buttons\",children:[/*#__PURE__*/_jsx(Link,{to:{pathname:\"/watch\",state:{movie:bigMovie}},children:/*#__PURE__*/_jsxs(\"button\",{className:\"play\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-play\",style:{fontSize:\"14px\"}}),/*#__PURE__*/_jsx(\"span\",{children:\"Play\"})]})}),/*#__PURE__*/_jsxs(\"button\",{className:\"more\",onClick:function onClick(){return setInfoModal(true);},children:[/*#__PURE__*/_jsx(InfoOutlined,{}),/*#__PURE__*/_jsx(\"span\",{children:\" More Info\"})]}),infoModal&&/*#__PURE__*/_jsx(InfoModal,{infoModal:infoModal,setInfoModal:setInfoModal,bigMovie:bigMovie})]})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"age\",children:[bigMovie.limitAge,\"+\"]})]});};export default Featured;","map":{"version":3,"sources":["/home/thangnq/Code/netflix_mern/frontend/src/components/featured/Featured.js"],"names":["InfoOutlined","React","useEffect","useRef","useState","Category","getDataAPI","useDispatch","useSelector","Link","useLocation","InfoModal","Featured","type","listRandom","bigMovie","setBigMovie","infoModal","setInfoModal","effectTitle","setEffectTitle","feature","setFeature","state","auth","genre","pathName","setPathName","genreChange","setGenreChange","videoRef","location","dispatch","getBigMovie","token","res","data","console","log","effectTimeout","setTimeout","featureTimeout","pathname","clearTimeout","options","rootMargin","threshold","handlePlay","entries","observer","forEach","entry","current","isIntersecting","play","pause","IntersectionObserver","observe","poster","trailer","posterTitle","desc","movie","fontSize","limitAge"],"mappings":"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","sourcesContent":["import { InfoOutlined } from \"@material-ui/icons\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport Category from \"../category/Category\";\nimport { getDataAPI } from \"../../utils/fetchData\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Link, useLocation } from \"react-router-dom\";\nimport InfoModal from \"../infomodal/InfoModal\";\nimport \"./featured.scss\";\n\nconst Featured = ({ type, listRandom }) => {\n  const [bigMovie, setBigMovie] = useState({});\n  const [infoModal, setInfoModal] = useState(false);\n  const [effectTitle, setEffectTitle] = useState(false);\n  const [feature, setFeature] = useState(\"image\");\n  const { auth, genre } = useSelector((state) => state);\n  const [pathName, setPathName] = useState(\"/\");\n  const [genreChange, setGenreChange] = useState(\"\");\n  const videoRef = useRef(null);\n  const location = useLocation();\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    const getBigMovie = async () => {\n      //`lists${type ? \"?type=\" + type : \"\"}${genre ? \"&genre=\" + genre : \"\"\n      try {\n        const res = await getDataAPI(\n          `movie/random${type ? \"?type=\" + type : \"\"}${\n            type && genre ? \"&genre=\" + genre : \"\"\n          }`,\n          auth.token\n        );\n\n        setBigMovie(res.data);\n      } catch (err) {\n        console.log(err);\n      }\n    };\n    getBigMovie();\n  }, [auth.token, type, genre]);\n\n  useEffect(() => {\n    const effectTimeout = setTimeout(() => {\n      setEffectTitle(true);\n    }, 6000);\n    if (feature === \"image\") {\n      var featureTimeout = setTimeout(() => {\n        setFeature(\"video\");\n      }, 3500);\n    }\n    if (pathName !== location.pathname || genreChange !== genre) {\n      setFeature(\"image\");\n      setEffectTitle(false);\n      setGenreChange(genre);\n      setPathName(location.pathname);\n    }\n\n    return () => {\n      clearTimeout(effectTimeout);\n      clearTimeout(featureTimeout);\n    };\n  }, [location.pathname, pathName, feature, dispatch, genre, genreChange]);\n\n  useEffect(() => {\n    if (feature === \"video\") {\n      let options = {\n        rootMargin: \"0px\",\n        threshold: [0.25, 0.75],\n      };\n\n      let handlePlay = (entries, observer) => {\n        entries.forEach((entry) => {\n          if (videoRef.current) {\n            if (entry.isIntersecting) {\n              videoRef.current.play();\n            } else {\n              videoRef.current.pause();\n            }\n          }\n        });\n      };\n\n      let observer = new IntersectionObserver(handlePlay, options);\n      observer.observe(videoRef.current);\n    }\n  }, [feature]);\n\n  useEffect(() => {\n    if (videoRef.current) {\n      if (feature === \"video\" && infoModal) {\n        videoRef.current.pause();\n      } else {\n        videoRef.current.play();\n      }\n    }\n  }, [feature, infoModal]);\n\n  return (\n    <div className=\"featured\">\n      {type && <Category type={type} />}\n      {feature === \"image\" ? (\n        <img src={bigMovie.poster} alt=\"Movie background\" className=\"poster\" />\n      ) : (\n        <video\n          ref={videoRef}\n          className=\"video\"\n          autoPlay\n          src={bigMovie.trailer}\n        />\n      )}\n      <div className={`info ${effectTitle && \"effect\"}`}>\n        <img src={bigMovie.posterTitle} alt=\"Movie name\" className=\"title\" />\n        <p className=\"desc\">{bigMovie.desc}</p>\n        <div className=\"buttons\">\n          <Link to={{ pathname: \"/watch\", state: { movie: bigMovie } }}>\n            <button className=\"play\">\n              <i className=\"fas fa-play\" style={{ fontSize: \"14px\" }}></i>\n              <span>Play</span>\n            </button>\n          </Link>\n          <button className=\"more\" onClick={() => setInfoModal(true)}>\n            <InfoOutlined />\n            <span> More Info</span>\n          </button>\n          {infoModal && (\n            <InfoModal\n              infoModal={infoModal}\n              setInfoModal={setInfoModal}\n              bigMovie={bigMovie}\n            />\n          )}\n        </div>\n      </div>\n      <span className=\"age\">{bigMovie.limitAge}+</span>\n    </div>\n  );\n};\n\nexport default Featured;\n"]},"metadata":{},"sourceType":"module"}