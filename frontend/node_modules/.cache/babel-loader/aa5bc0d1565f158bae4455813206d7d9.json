{"ast":null,"code":"import _regeneratorRuntime from\"/home/thangnq/Code/netflix_mern/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/thangnq/Code/netflix_mern/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/thangnq/Code/netflix_mern/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useRef,useState}from\"react\";import{getDataAPI}from\"../../utils/fetchData\";import{useSelector,useDispatch}from\"react-redux\";import{GLOBALTYPES}from\"../../redux/actions/globalTypes\";import{jsx as _jsx}from\"react/jsx-runtime\";var SearchBox=function SearchBox(_ref){var searchQuery=_ref.searchQuery;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),resultSearch=_useState2[0],setResultSearch=_useState2[1];var _useSelector=useSelector(function(state){return state;}),auth=_useSelector.auth,search=_useSelector.search;var debounceSearch=useRef(null);var dispatch=useDispatch();useEffect(function(){if(debounceSearch.current){clearTimeout(debounceSearch.current);}debounceSearch.current=setTimeout(function(){var startTime=Date.now();var getSearch=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,timeQuery;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;if(!searchQuery){_context.next=10;break;}_context.next=4;return getDataAPI(\"movie/search\".concat(searchQuery?\"?searchString=\"+searchQuery:\"?searchString=''\"),auth.token);case 4:res=_context.sent;timeQuery=Date.now()-startTime;setResultSearch(res.data);dispatch({type:GLOBALTYPES.GETSEARCH,payload:{data:res.data,query:searchQuery,timeQuery:timeQuery}});_context.next=11;break;case 10:dispatch({type:GLOBALTYPES.GETSEARCH,payload:{query:\"\"}});case 11:_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 16:case\"end\":return _context.stop();}}},_callee,null,[[0,13]]);}));return function getSearch(){return _ref2.apply(this,arguments);};}();getSearch();},250);},[searchQuery,auth.token,dispatch]);return/*#__PURE__*/_jsx(\"div\",{});};export default SearchBox;","map":{"version":3,"sources":["/home/thangnq/Code/netflix_mern/frontend/src/components/search-box/SearchBox.js"],"names":["React","useEffect","useRef","useState","getDataAPI","useSelector","useDispatch","GLOBALTYPES","SearchBox","searchQuery","resultSearch","setResultSearch","state","auth","search","debounceSearch","dispatch","current","clearTimeout","setTimeout","startTime","Date","now","getSearch","token","res","timeQuery","data","type","GETSEARCH","payload","query","console","log"],"mappings":"0dAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,MAA3B,CAAmCC,QAAnC,KAAmD,OAAnD,CACA,OAASC,UAAT,KAA2B,uBAA3B,CACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,aAAzC,CACA,OAASC,WAAT,KAA4B,iCAA5B,C,2CAEA,GAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,MAAqB,IAAlBC,CAAAA,WAAkB,MAAlBA,WAAkB,CACrC,cAAwCN,QAAQ,CAAC,EAAD,CAAhD,wCAAOO,YAAP,eAAqBC,eAArB,eACA,iBAAyBN,WAAW,CAAC,SAACO,KAAD,QAAWA,CAAAA,KAAX,EAAD,CAApC,CAAQC,IAAR,cAAQA,IAAR,CAAcC,MAAd,cAAcA,MAAd,CACA,GAAMC,CAAAA,cAAc,CAAGb,MAAM,CAAC,IAAD,CAA7B,CACA,GAAMc,CAAAA,QAAQ,CAAGV,WAAW,EAA5B,CAEAL,SAAS,CAAC,UAAM,CACd,GAAIc,cAAc,CAACE,OAAnB,CAA4B,CAC1BC,YAAY,CAACH,cAAc,CAACE,OAAhB,CAAZ,CACD,CAEDF,cAAc,CAACE,OAAf,CAAyBE,UAAU,CAAC,UAAM,CACxC,GAAMC,CAAAA,SAAS,CAAGC,IAAI,CAACC,GAAL,EAAlB,CACA,GAAMC,CAAAA,SAAS,2FAAG,yKAEVd,WAFU,gDAGML,CAAAA,UAAU,uBAExBK,WAAW,CACP,iBAAmBA,WADZ,CAEP,kBAJoB,EAM1BI,IAAI,CAACW,KANqB,CAHhB,QAGNC,GAHM,eAYNC,SAZM,CAYML,IAAI,CAACC,GAAL,GAAaF,SAZnB,CAcZT,eAAe,CAACc,GAAG,CAACE,IAAL,CAAf,CAEAX,QAAQ,CAAC,CACPY,IAAI,CAAErB,WAAW,CAACsB,SADX,CAEPC,OAAO,CAAE,CACPH,IAAI,CAAEF,GAAG,CAACE,IADH,CAEPI,KAAK,CAAEtB,WAFA,CAGPiB,SAAS,CAAEA,SAHJ,CAFF,CAAD,CAAR,CAhBY,+BAyBZV,QAAQ,CAAC,CACPY,IAAI,CAAErB,WAAW,CAACsB,SADX,CAEPC,OAAO,CAAE,CACPC,KAAK,CAAE,EADA,CAFF,CAAD,CAAR,CAzBY,yFAiCdC,OAAO,CAACC,GAAR,cAjCc,qEAAH,kBAATV,CAAAA,SAAS,2CAAf,CAoCAA,SAAS,GACV,CAvCkC,CAuChC,GAvCgC,CAAnC,CAwCD,CA7CQ,CA6CN,CAACd,WAAD,CAAcI,IAAI,CAACW,KAAnB,CAA0BR,QAA1B,CA7CM,CAAT,CA8CA,mBAAO,cAAP,CACD,CArDD,CAuDA,cAAeR,CAAAA,SAAf","sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport { getDataAPI } from \"../../utils/fetchData\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { GLOBALTYPES } from \"../../redux/actions/globalTypes\";\n\nconst SearchBox = ({ searchQuery }) => {\n  const [resultSearch, setResultSearch] = useState([]);\n  const { auth, search } = useSelector((state) => state);\n  const debounceSearch = useRef(null);\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    if (debounceSearch.current) {\n      clearTimeout(debounceSearch.current);\n    }\n\n    debounceSearch.current = setTimeout(() => {\n      const startTime = Date.now();\n      const getSearch = async () => {\n        try {\n          if (searchQuery) {\n            const res = await getDataAPI(\n              `movie/search${\n                searchQuery\n                  ? \"?searchString=\" + searchQuery\n                  : \"?searchString=''\"\n              }`,\n              auth.token\n            );\n\n            const timeQuery = Date.now() - startTime;\n\n            setResultSearch(res.data);\n\n            dispatch({\n              type: GLOBALTYPES.GETSEARCH,\n              payload: {\n                data: res.data,\n                query: searchQuery,\n                timeQuery: timeQuery,\n              },\n            });\n          } else {\n            dispatch({\n              type: GLOBALTYPES.GETSEARCH,\n              payload: {\n                query: \"\",\n              },\n            });\n          }\n        } catch (err) {\n          console.log(err);\n        }\n      };\n      getSearch();\n    }, 250);\n  }, [searchQuery, auth.token, dispatch]);\n  return <div></div>;\n};\n\nexport default SearchBox;\n"]},"metadata":{},"sourceType":"module"}